# Ersilia compound embedding

This library provides bioactivity aware chemical embeddings for small molecules.
The `lite` directory contains the `eosce` library intended for end-user use.
The `compound-embedding` library is intended for development use.

## Quick start guide

### 1. Clone the repository

```bash
git clone https://github.com/ersilia-os/compound-embedding.git
cd compound-embedding/lite
```

### 2. Install the package with pip

```bash
pip install -e .
```

or if you have a GPU

```bash
pip install -e .[gpu]
```

### 3. Programatically generate embeddings

```python
from eosce.models import ErsiliaCompoundEmbeddings
model = ErsiliaCompoundEmbeddings()
embeddings = model.transform(["CCOC(=O)C1=CC2=CC(OC)=CC=C2O1"])
```

### 4. Generate embeddings using the cli

```bash
eosce embed "CCOC(=O)C1=CC2=CC(OC)=CC=C2O1"
```

## Developing

### 1. Clone the repository

```bash
git clone https://github.com/ersilia-os/compound-embedding.git
cd compound-embedding
```

### 2. Create a conda environment and activate it

```bash
conda env create -f env.yaml
conda activate crux
```

### 3. Install the project using pip

```bash
pip install -e .
```

## Project Architecture

### Phase 1

We generated a unique dataset that contains grover descriptors, mordred descriptors and Assay labels for the molecules present in the FS-MOL dataset.
This dataset is then used to train a ProtoNET with euclidean distance as the metric.

<img src="./phase_1.png" alt="Phase 1" style="width:800px;"/>

### Phase 2

We then used the trained Protonet to generate 2 million embedding for the molecules in the reference library generated using CHEMBL.

<img src="./phase_2.png" alt="Phase 2" style="width:800px;"/>

### Phase 3

Finally we used the generated training dataset generated in Phase 2 to train a simple and fast neural network that maps ECFPs to embeddings generated by the ProtoNET.

<img src="./phase_3.png" alt="Phase 3" style="width:800px;"/>

## Getting required dataset

## License

This repository is open-sourced under [the GPL-3 License](https://github.com/ersilia-os/ersilia/blob/master/LICENSE). Please [cite us](https://github.com/ersilia-os/ersilia/blob/master/CITATION.cff) if you use it.

## About Us

The [Ersilia Open Source Initiative](https://ersilia.io) is a Non Profit Organization ([1192266](https://register-of-charities.charitycommission.gov.uk/charity-search/-/charity-details/5170657/full-print)) with the mission is to equip labs, universities and clinics in LMIC with AI/ML tools for infectious disease research.

[Help us](https://www.ersilia.io/donate) achieve our mission or [volunteer](https://www.ersilia.io/volunteer) with us!